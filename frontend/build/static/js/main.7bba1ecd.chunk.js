(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{39:function(e,t,n){},59:function(e,t,n){},64:function(e,t,n){},65:function(e,t,n){},66:function(e,t,n){},68:function(e,t,n){"use strict";n.r(t);var c=n(0),s=n.n(c),o=n(13),a=n.n(o),r=(n(39),n(3)),i=n(12),d=n(4),u=n(17),l=n(18),j=n(10),b=n.n(j),O="http://localhost:8080/",h=new(function(){function e(){Object(u.a)(this,e)}return Object(l.a)(e,[{key:"login",value:function(e,t){return b.a.post(O+"login",{username:e,password:t}).then((function(e){return e.data.access_token&&localStorage.setItem("user",JSON.stringify(e.data)),e.data}))}},{key:"logout",value:function(){localStorage.removeItem("user")}},{key:"register",value:function(e,t){return b.a.post(O+"register",{username:e,password:t})}},{key:"getCurrentUser",value:function(){return JSON.parse(localStorage.getItem("user"))}}]),e}()),g=n(1);var x=function(e){var t=e.message,n=e.color;return Object(g.jsx)("p",{style:{color:n},children:t})};n(59);var f=function(e){var t=e.login,n=e.logout,s=Object(c.useState)(""),o=Object(r.a)(s,2),a=o[0],i=o[1],u=Object(c.useState)(""),l=Object(r.a)(u,2),j=l[0],b=l[1],O=Object(d.g)(),f=Object(c.useState)(!1),m=Object(r.a)(f,2),v=m[0],p=m[1],y=Object(c.useState)(""),C=Object(r.a)(y,2),I=C[0],S=C[1],k=Object(c.useState)(""),D=Object(r.a)(k,2),N=D[0],E=D[1];return Object(g.jsx)("div",{className:"loginForm",children:Object(g.jsxs)("form",{className:"form",onSubmit:function(e){e.preventDefault(),a.trim()&&j.trim()&&(v?h.register(a,j).then((function(){S("successfully registered"),E("GREEN")})).catch((function(e){void 0===e.response?(S(e.message),E("RED")):(S(e.response.data),E("RED"))})):h.login(a,j).then((function(){t(),S(""),E(""),O.push("/todo")})).catch((function(e){if(n(),void 0===e.response)S(e.message),E("RED");else if(401===e.response.status){S("Invalid login or password"),E("RED")}})),i(""),b(""))},children:[Object(g.jsxs)("div",{children:[Object(g.jsx)("label",{htmlFor:"username",children:"Username"}),Object(g.jsx)("br",{}),Object(g.jsx)("input",{type:"text",value:a,onChange:function(e){i(e.target.value)}})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("label",{htmlFor:"password",children:"Password"}),Object(g.jsx)("br",{}),Object(g.jsx)("input",{type:"password",value:j,onChange:function(e){b(e.target.value)}})]}),Object(g.jsxs)("div",{className:"buttons",children:[Object(g.jsx)("button",{type:"submit",onClick:function(){return p(!1)},children:Object(g.jsx)("span",{children:"Login"})}),Object(g.jsx)("button",{type:"submit",onClick:function(){return p(!0)},children:"Register"})]}),I?Object(g.jsx)(x,{style:{padding:"10px"},color:N,message:I}):void 0]})})};var m=function(e){var t=e.logIn,n=e.logOut;return Object(g.jsxs)("div",{style:{textAlign:"center"},children:[Object(g.jsx)("h1",{children:"Welcome to home page"}),Object(g.jsx)("div",{children:Object(g.jsx)(f,{login:t,logout:n})})]})},v=n(11);var p=function(e){var t=e.tag;return Object(g.jsx)("div",{className:"tag",style:{backgroundColor:t.color},children:Object(g.jsx)("strong",{children:t.title})})};n(64);var y=function(e){var t=e.addTag,n=e.item,o=e.message,a=e.messageColor,i=e.clearMessage,d=Object(c.useState)(!1),u=Object(r.a)(d,2),l=u[0],j=u[1],b=["CRIMSON","DEEPSKYBLUE","BLACK","LIMEGREEN"],O=Object(c.useState)(b[0]),h=Object(r.a)(O,2),f=h[0],m=h[1],v=Object(c.useState)(1),p=Object(r.a)(v,2),y=p[0],C=p[1],I=Object(c.useState)(""),S=Object(r.a)(I,2),k=S[0],D=S[1];return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)("button",{style:{width:"30px"},onClick:function(){return j(!0)},children:"+"}),l&&Object(g.jsx)("div",{className:"modal",children:Object(g.jsxs)("div",{className:"modal-body",children:[Object(g.jsx)("h1",{children:"Add new tag"}),Object(g.jsx)("div",{children:Object(g.jsxs)("form",{style:{textAlign:"center"},onSubmit:function(e){if(e.preventDefault(),!(k.length>20)&&k.trim()){var c={id:Date.now(),title:k,color:f,itemId:n.id};t(c),D(" ")}},children:[Object(g.jsxs)("div",{style:{display:"flex",justifyContent:"center"},children:[Object(g.jsx)("button",{className:"color-button",style:{backgroundColor:f},onClick:function(){C((y+1)%4),m(b[y])}}),Object(g.jsx)("input",{value:k,type:"text",onChange:function(e){D(e.target.value)}})]}),Object(g.jsx)("div",{className:"buttonDiv",children:Object(g.jsx)("button",{type:"submit",children:"Add tag"})}),Object(g.jsx)("div",{className:"buttonDiv",children:Object(g.jsx)("button",{onClick:function(){j(!1),i()},children:"close"})})]})}),o?Object(g.jsx)(x,{color:a,message:o}):void 0]})})]})},C={li:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:".5rem 2rem",border:"1px solid #ccc",borderRadius:"5px",marginBottom:".5rem"}};var I=function(e){var t=e.item,n=e.toggleItem,c=e.removeItem,s=e.tags,o=e.addTag,a=e.message,r=e.color,i=e.clearMessage,d=[];return t.done&&(d.push("done"),d.push("doneText")),Object(g.jsxs)("li",{style:C.li,className:d.join(" "),children:[Object(g.jsxs)("span",{className:d.join(" "),children:[Object(g.jsx)("input",{checked:t.done,type:"checkbox",onChange:function(){return n(t.id)}}),Object(g.jsx)("strong",{children:t.index}),"\xa0",t.title]}),Object(g.jsxs)("div",{style:{display:"flex"},children:[Object(g.jsx)("div",{style:{display:"flex"},children:s?s.map((function(e){return Object(g.jsx)(p,{tag:e},e.id)})):void 0}),Object(g.jsx)(y,{addTag:o,item:t,message:a,messageColor:r,clearMessage:i}),Object(g.jsx)("button",{style:{width:"30px"},onClick:function(){return c(t.id)},children:"\xd7"})]})]})};function S(){var e=JSON.parse(localStorage.getItem("user"));return e&&e.access_token?{Authorization:"Bearer "+e.access_token}:{}}var k="http://localhost:8080/todolist",D=new(function(){function e(){Object(u.a)(this,e)}return Object(l.a)(e,[{key:"addTag",value:function(e){return b.a.post(k+"/tag",e,{headers:S()})}},{key:"addItem",value:function(e){return b.a.post(k,e,{headers:S()})}},{key:"getTodoItems",value:function(e){return b.a.get(k,{params:{username:e},headers:S()})}},{key:"updateItemDone",value:function(e){return b.a.put(k+"/done",e,{headers:S()})}},{key:"removeItem",value:function(e){return b.a.delete(k,{params:{id:e},headers:S()})}},{key:"updateIndexes",value:function(e){return b.a.put(k+"/index",e,{headers:S()})}}]),e}());var N=function(e){var t=e.onCreate,n=Object(c.useState)(""),s=Object(r.a)(n,2),o=s[0],a=s[1];return Object(g.jsxs)("form",{style:{marginBottom:"1rem"},onSubmit:function(e){e.preventDefault(),o.trim()&&(t(o),a(""))},children:[Object(g.jsx)("input",{type:"text",value:o,onChange:function(e){a(e.target.value)}}),Object(g.jsx)("button",{type:"submit",children:"Add todo"})]})},E=n(19);n(65),n(66);var R=function(){return Object(g.jsx)("div",{style:{display:"flex",justifyContent:"center",margin:".5rem"},children:Object(g.jsx)("div",{className:"lds-dual-ring"})})};var w=function(){var e=Object(c.useState)(""),t=Object(r.a)(e,2),n=t[0],s=t[1],o=Object(c.useState)([]),a=Object(r.a)(o,2),i=a[0],d=a[1],u=Object(c.useState)(""),l=Object(r.a)(u,2),j=l[0],b=l[1],O=Object(c.useState)(""),f=Object(r.a)(O,2),m=f[0],p=f[1],y=Object(c.useState)(""),C=Object(r.a)(y,2),S=C[0],k=C[1],w=Object(c.useState)(!0),T=Object(r.a)(w,2),A=T[0],B=T[1];function M(){p("")}function P(e){var t=!0;d(i.map((function(n){if(n.id===e.itemId)if(n.tags){if(!(n.tags.length<3))return p("too much tags"),k("RED"),t=!1,n;n.tags.push(e),k(""),p("")}else n.tags=[e];return n}))),t&&D.addTag(e).catch((function(e){void 0===e.response&&(b("Changes can not be saved"),k("RED"))}))}function F(e){d(i.map((function(t){return t.id===e&&(t.done=!t.done,D.updateItemDone(t).then((function(){b(""),k("")})).catch((function(e){void 0===e.response&&(b("Changes can not be saved"),k("RED"))}))),t})))}function J(e){d(i.filter((function(t){return t.id!==e})).map((function(e,t){return e.index=t+1,e}))),D.removeItem(e).then((function(){b(""),k(""),D.updateIndexes(i).catch((function(){}))})).catch((function(e){void 0===e.response&&(b("Changes can not be saved"),k("RED"))}))}return Object(c.useEffect)((function(){s(h.getCurrentUser().username),D.getTodoItems(n).then((function(e){b(""),k(""),setTimeout((function(){B(!1)}),1e3),d(e.data)})).catch((function(e){void 0===e.response&&(b("Can not connect to server"),k("RED"),B(!1))}))}),[n]),Object(g.jsxs)("div",{children:[Object(g.jsxs)("div",{className:"todoForm",children:[Object(g.jsxs)("h1",{children:[n,"'s todo list"]}),Object(g.jsx)(N,{onCreate:function(e){var t={title:e,done:!1,index:i.length+1,id:Date.now(),ownerName:n};d(i.concat([t])),D.addItem(t).then((function(e){var t=e.data;d(i.concat([t])),b(""),k("")})).catch((function(e){void 0===e.response&&(b("Changes can not be saved"),k("RED"))}))}}),j?Object(g.jsx)(x,{message:j,color:S}):void 0]}),Object(g.jsx)(E.a,{onDragEnd:function(e){return function(e){var t,n=e.source.index,c=null===(t=e.destination)||void 0===t?void 0:t.index;i.splice(c,0,i.splice(n,1)[0]),d(i.map((function(e,t){return e.index=t+1,e}))),b(""),k(""),D.updateIndexes(i).catch((function(e){void 0===e.response&&(b("Changes can not be saved"),k("RED"))}))}(e)},children:Object(g.jsx)(E.c,{droppableId:"droppable-1",children:function(e,t){return Object(g.jsxs)("div",Object(v.a)(Object(v.a)({style:{textAlign:"center"},ref:e.innerRef},e.droppableProps),{},{children:[A?Object(g.jsx)(R,{}):i.length?i.map((function(e,t){return Object(g.jsx)(E.b,{draggableId:"draggable-"+e.id,index:t,children:function(t,n){return Object(g.jsx)("div",Object(v.a)(Object(v.a)(Object(v.a)({ref:t.innerRef},t.draggableProps),t.dragHandleProps),{},{style:Object(v.a)(Object(v.a)({},t.draggableProps.style),{},{borderRadius:"5px",boxShadow:n.isDragging?"0 0 .4rem #666":"none"}),children:Object(g.jsx)(I,{item:e,toggleItem:F,removeItem:J,tags:e.tags,addTag:P,message:m,color:S,clearMessage:M},e.id)}))}},e.id)})):A?void 0:Object(g.jsx)("p",{children:"No todo!"}),e.placeholder]}))}})})]})};var T=function(e){return Object(g.jsx)(d.b,{path:e.path,render:function(t){return e.login?Object(g.jsx)(e.component,Object(v.a)({},t)):Object(g.jsx)(d.a,{to:{pathname:"/"}})}})};var A=function(){var e=Object(c.useState)(!!h.getCurrentUser()),t=Object(r.a)(e,2),n=t[0],s=t[1];function o(){s(!1)}return Object(g.jsxs)("div",{children:[Object(g.jsxs)("div",{className:"header",children:[Object(g.jsx)("h2",{children:Object(g.jsx)(i.b,{style:{textDecoration:"none",color:"black"},to:"/",children:"Home"})}),Object(g.jsx)("h2",{children:Object(g.jsx)(i.b,{style:{textDecoration:"none",color:"black"},to:"/todo",children:"Todo list"})}),Object(g.jsx)("div",{className:"logout",children:n?Object(g.jsx)("button",{onClick:function(){h.logout(),o()},children:"Logout"}):void 0})]}),Object(g.jsx)("hr",{}),Object(g.jsx)("div",{className:"content",children:Object(g.jsxs)(d.d,{children:[Object(g.jsx)(d.b,{exact:!0,path:"/",children:Object(g.jsx)(m,{logIn:function(){s(!0)},logOut:o})}),Object(g.jsx)(T,{path:"/todo",component:w,login:n})]})})]})};a.a.render(Object(g.jsx)(i.a,{children:Object(g.jsx)(A,{})}),document.getElementById("root"))}},[[68,1,2]]]);
//# sourceMappingURL=main.7bba1ecd.chunk.js.map